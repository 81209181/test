<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hkt.btu.sd.core.dao.mapper.SdCompanyMapper" >
    <resultMap id="SdCompanyEntity" type="com.hkt.btu.sd.core.dao.entity.SdCompanyEntity" >
        <result column="COMPANY_ID" property="companyId" />
        <result column="NAME" property="name" />
        <result column="STATUS" property="status" />

        <result column="CREATEDATE" property="createdate" />
        <result column="CREATEBY" property="createby" />
        <result column="MODIFYDATE" property="modifydate" />
        <result column="MODIFYBY" property="modifyby" />
        <result column="REMARKS" property="remarks" />
    </resultMap>


    <select id="getCompanyByCompanyId" resultMap="SdCompanyEntity" >
        select *
        from NOC_COMPANY
        where COMPANY_ID = #{companyId}
    </select>

    <select id="getCompany" resultMap="SdCompanyEntity" >
        select *
        from NOC_COMPANY
        <where>
            <if test="status != null">
                STATUS = #{status}
            </if>
        </where>
    </select>

    <insert id="insertCompany" parameterType="com.hkt.btu.sd.core.dao.entity.SdCompanyEntity"
            useGeneratedKeys="true" keyProperty="companyId">
        insert into NOC_COMPANY (COMPANY_ID, NAME, STATUS, CREATEBY, MODIFYBY, REMARKS)
        values (#{companyId}, #{name}, #{status}, #{createby}, #{createby}, #{remarks})
    </insert>

    <update id="updateCompanyByCompanyId" >
        update NOC_COMPANY
        <set>
            <if test = "name != null">NAME = #{name},</if>
            <if test = "remarks != null">REMARKS = #{remarks},</if>
            <if test = "modifyby != null">MODIFYBY = #{modifyby}</if>
        </set>
        where COMPANY_ID = #{companyId}
    </update>

    <sql id="searchCompanySql">
        from NOC_COMPANY
        <where>
            <if test="companyId != null">
                COMPANY_ID = #{companyId}
            </if>
            <if test="name != null">
                <bind name="like_name" value="'%' + name + '%'" />
                AND NAME like #{like_name}
            </if>
        </where>
    </sql>
    <select id="searchCompany" resultMap="SdCompanyEntity" >
        # noinspection SqlResolve
        select *
        <include refid="searchCompanySql"/>
        order by COMPANY_ID
        LIMIT #{offset}, #{pageSize}
    </select>
    <select id="countSearchCompany" resultType="Integer" >
        select count(1)
        <include refid="searchCompanySql"/>
    </select>


</mapper>
